The abundance of ribosomal RNA (rRNA) in cells complicates the sequencing of mRNA and noncoding RNA. In RNA-seq studies, rRNA is therefore typically removed by one of two library-preparation methods. In ribo-depletion, rRNA sequences are selectively removed from the RNA sample. In poly-A enrichment, only those RNA molecules bearing the poly-A tail found on mature mRNAs are retained. These two methods yield different pools of RNA molecules which cannot be compared to one another directly. 

The ability to compare ribo-depleted samples to poly-A-enriched samples would broaden the range of data available for RNA-seq studies, increasing the value of existing RNA-seq data. Theoretically, a poly-A-enriched sample is a subset of a ribo-depleted sample. It therefore might be possible to statistically downsample a set of sequencing reads obtained from a ribo-depleted sample to produce a set of reads approximating what would have been obtained had poly-A-enrichment been used in library preparation. The goal of this project, which was proposed and overseen by Dr. Adam Labadorf and conducted under the auspices of the Flynn lab on the Boston University medical campus, was to develop an algorithm for this downsampling, based on a theoretical understanding of the pools of molecules that should be yielded by these two methods. As well as excluding RNA molecules that do not code for proteins, a successful algorithm should exclude immature mRNAs, which do not yet bear a poly-A tail and should therefore not occur in a poly-A-enriched sample. In the absence of alternative splicing, the ratio of mature to immature mRNA strands for a particular gene in a sample can be estimated from the ratio of spliced to unspliced paired reads, when those reads bridge a splice junction. 

Dr. Labadorf and I worked together to develop this approach to the problem. The further development of the algorithm and the writing of the code were done almost entirely by me, with Dr. Labadorf training me in the use of the necessary tools and utilities, and overseeing the quality of the resulting code. The main product is a pipeline that takes as input the reference numbers for raw sets of ribo-depleted RNA sequencing reads archived in the NCBI GEO database. The pipeline then performs the following operations. Operations 1 and 2 are performed by 'Snakefile_twopass_v3', and operations 3-5 are performed by 'Snakefile_pt2'.
	
1) Download of the reads associated with those reference numbers; 
	
2) Alignment using STAR and the identification of splice junctions based on i) genome annotation and ii) the empirical appearance of possible splice junctions in the data itself;
	
3) Identification of high-quality annotations for each protein-coding gene in the genome, and, from those annotations, the identification of exonic and intronic regions in those genes, taking into account evidence of alternative splicing;
	
4) Execution of an algorithm that, based on the ratio of spliced to unspliced pairs of reads at each splice junction in each protein-coding gene, estimates the number of reads that should be sampled from exonic regions to most closely approximate the structure of a poly-A-enriched sample generated from the same genetic source material;
	
5) Quantification of transcript expression using Salmon. The data output by Salmon at this stage can be passed to DESeq2 (in R) for differential expression analysis. The R code in 'DE_analysis.RMd' performs this analysis.
